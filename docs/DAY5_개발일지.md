# DAY 5 ê°œë°œì¼ì§€ - í”¼ë“œ ë° ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

**ë‚ ì§œ**: 2025ë…„ 11ì›” 29ì¼  
**ëª©í‘œ**: ì½˜í…ì¸  íƒìƒ‰ ë° ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

---

## ğŸ“‹ ì˜¤ëŠ˜ì˜ ëª©í‘œ

1. í”¼ë“œ í˜ì´ì§€ êµ¬í˜„ (íŒ”ë¡œì‰ í”¼ë“œ, íƒìƒ‰ í”¼ë“œ)
2. í”¼ë“œ ì •ë ¬ ê¸°ëŠ¥ (ìµœì‹ ìˆœ, ì¸ê¸°ìˆœ)
3. ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„ (ë§ˆì»¤ ê²€ìƒ‰, ì‚¬ìš©ì ê²€ìƒ‰)
4. ì§€ë„ í˜ì´ì§€ ê²€ìƒ‰ ê¸°ëŠ¥
5. ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„ (Intersection Observer í™œìš©)
6. ì¸ê¸° ë§ˆì»¤ ì¡°íšŒ ê¸°ëŠ¥
7. ì£¼ë³€ ë§ˆì»¤ ì¡°íšŒ ê¸°ëŠ¥

---

## âœ… ì™„ë£Œ ì‘ì—…

### 1. í”¼ë“œ í˜ì´ì§€ êµ¬í˜„

#### í˜ì´ì§€ êµ¬ì„±
- íƒ­ ì „í™˜ (íŒ”ë¡œì‰ / íƒìƒ‰)
- ì •ë ¬ ì˜µì…˜ (NEW / HOT)
- ë§ˆì»¤ ì¹´ë“œ ëª©ë¡
- ë¬´í•œ ìŠ¤í¬ë¡¤

#### íŒ”ë¡œì‰ í”¼ë“œ
- **API**: `GET /api/feed`
- íŒ”ë¡œìš°í•œ ì‚¬ìš©ìë“¤ì˜ ë§ˆì»¤ë§Œ í‘œì‹œ
- ë¡œê·¸ì¸ í•„ìˆ˜
- ìµœì‹ ìˆœ ì •ë ¬

#### íƒìƒ‰ í”¼ë“œ
- **API**: `GET /api/feed/explore`
- ëª¨ë“  ì‚¬ìš©ìì˜ ë§ˆì»¤ í‘œì‹œ
- ë¡œê·¸ì¸ ë¶ˆí•„ìš”
- ì •ë ¬ ì˜µì…˜ (ìµœì‹ ìˆœ, ì¸ê¸°ìˆœ)

#### ë§ˆì»¤ ì¹´ë“œ êµ¬ì„±
- í”„ë¡œí•„ ì´ë¯¸ì§€ ë° ë‹‰ë„¤ì„
- ë§ˆì»¤ ì´ë¯¸ì§€
- 3ì¤„ í…ìŠ¤íŠ¸
- ì¢‹ì•„ìš” ìˆ˜, ëŒ“ê¸€ ìˆ˜
- ì‘ì„± ì‹œê°„
- ì¢‹ì•„ìš”/ë¶ë§ˆí¬ ë²„íŠ¼
- ì§€ë„ ë³´ê¸° ë²„íŠ¼

### 2. í”¼ë“œ ì •ë ¬ ê¸°ëŠ¥

#### ì •ë ¬ ì˜µì…˜
- **NEW (ìµœì‹ ìˆœ)**: CREATED_AT ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ
- **HOT (ì¸ê¸°ìˆœ)**: ì¢‹ì•„ìš” ìˆ˜ + ëŒ“ê¸€ ìˆ˜ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ

#### êµ¬í˜„ ë°©ë²•
- ì„œë²„ ì‚¬ì´ë“œ ì •ë ¬
- ì •ë ¬ ì˜µì…˜ì„ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
- ì •ë ¬ ë³€ê²½ ì‹œ í”¼ë“œ ìƒˆë¡œê³ ì¹¨

#### ì½”ë“œ ì˜ˆì‹œ
```sql
-- ìµœì‹ ìˆœ
ORDER BY CREATED_AT DESC

-- ì¸ê¸°ìˆœ
ORDER BY (LIKE_COUNT + COMMENT_COUNT) DESC, CREATED_AT DESC
```

### 3. ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

#### í†µí•© ê²€ìƒ‰
- **API**: `GET /api/search`
- ë§ˆì»¤ì™€ ì‚¬ìš©ìë¥¼ ë™ì‹œì— ê²€ìƒ‰
- ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸

#### ë§ˆì»¤ ê²€ìƒ‰
- **API**: `GET /api/search/markers`
- ë§ˆì»¤ í…ìŠ¤íŠ¸ (line1, line2, line3) ê²€ìƒ‰
- ì¹´í…Œê³ ë¦¬ í•„í„°ë§
- ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰ (ì¶”í›„ êµ¬í˜„)

#### ì‚¬ìš©ì ê²€ìƒ‰
- **API**: `GET /api/search/users`
- ì‚¬ìš©ì ID, ë‹‰ë„¤ì„ ê²€ìƒ‰
- í”„ë¡œí•„ ì´ë¯¸ì§€ í‘œì‹œ

#### ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
- ë§ˆì»¤ ê²°ê³¼ì™€ ì‚¬ìš©ì ê²°ê³¼ ë¶„ë¦¬
- ê²°ê³¼ í´ë¦­ ì‹œ í•´ë‹¹ í˜ì´ì§€ë¡œ ì´ë™
- ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸

### 4. ì§€ë„ í˜ì´ì§€ ê²€ìƒ‰ ê¸°ëŠ¥

#### ê²€ìƒ‰ ì…ë ¥ ì»´í¬ë„ŒíŠ¸
- `MapSearchInput` ì»´í¬ë„ŒíŠ¸ ìƒì„±
- ìë™ì™„ì„± ê¸°ëŠ¥
- ë””ë°”ìš´ì‹± ì ìš© (300ms)

#### ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
- ë“œë¡­ë‹¤ìš´ ëª©ë¡
- ë§ˆì»¤ ê²°ê³¼ í´ë¦­ ì‹œ ì§€ë„ ì´ë™
- ì‚¬ìš©ì ê²°ê³¼ í´ë¦­ ì‹œ í”„ë¡œí•„ í˜ì´ì§€ ì´ë™

#### ì§€ë„ ì—°ë™
- ê²€ìƒ‰ ê²°ê³¼ ë§ˆì»¤ í•˜ì´ë¼ì´íŠ¸
- ì„ íƒëœ ë§ˆì»¤ë¡œ ì§€ë„ ì´ë™
- ë§ˆì»¤ í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸

### 5. ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„

#### Intersection Observer í™œìš©
- í•˜ë‹¨ì— ê°ì‹œ ì˜ì—­ ë°°ì¹˜
- ê°ì‹œ ì˜ì—­ì´ ë³´ì´ë©´ ë‹¤ìŒ í˜ì´ì§€ ë¡œë“œ
- ë¡œë”© ìƒíƒœ í‘œì‹œ

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­
- `useRef`ë¡œ ê°ì‹œ ì˜ì—­ ì°¸ì¡°
- `useCallback`ìœ¼ë¡œ ì½œë°± í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
- í˜ì´ì§€ ë²ˆí˜¸ ê´€ë¦¬
- ë” ì´ìƒ ë°ì´í„°ê°€ ì—†ì„ ë•Œ ì²˜ë¦¬

#### ì½”ë“œ êµ¬ì¡°
```javascript
const loadMoreRef = useRef();
const [page, setPage] = useState(1);
const [hasMore, setHasMore] = useState(true);

useEffect(() => {
    const observer = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting && hasMore && !loading) {
            loadFeed(page + 1);
        }
    }, {
        root: null,
        rootMargin: '100px',
        threshold: 0
    });
    
    if (loadMoreRef.current) {
        observer.observe(loadMoreRef.current);
    }
    
    return () => observer.disconnect();
}, [hasMore, loading, page, loadFeed]);
```

### 6. ì¸ê¸° ë§ˆì»¤ ì¡°íšŒ ê¸°ëŠ¥

#### API êµ¬í˜„
- `GET /api/markers/popular`
- ì¢‹ì•„ìš” ìˆ˜ + ëŒ“ê¸€ ìˆ˜ ê¸°ì¤€ ì •ë ¬
- ê¸°ê°„ í•„í„°ë§ (ì˜¤ëŠ˜, ì´ë²ˆ ì£¼, ì´ë²ˆ ë‹¬)

#### í™œìš©
- íƒìƒ‰ í”¼ë“œì˜ HOT ì •ë ¬
- ë©”ì¸ í˜ì´ì§€ ì¶”ì²œ ë§ˆì»¤ (ì¶”í›„ êµ¬í˜„)

### 7. ì£¼ë³€ ë§ˆì»¤ ì¡°íšŒ ê¸°ëŠ¥

#### API êµ¬í˜„
- `GET /api/markers/nearby`
- í˜„ì¬ ìœ„ì¹˜ ê¸°ì¤€ ë°˜ê²½ ë‚´ ë§ˆì»¤ ì¡°íšŒ
- ê±°ë¦¬ ê³„ì‚° (Haversine formula)

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­
- ìœ„ë„/ê²½ë„ íŒŒë¼ë¯¸í„°
- ë°˜ê²½ ì„¤ì • (ê¸°ë³¸ 5km)
- ê±°ë¦¬ìˆœ ì •ë ¬

#### ì½”ë“œ ì˜ˆì‹œ
```sql
SELECT *,
    (6371 * acos(
        cos(radians(?)) * cos(radians(LATITUDE)) *
        cos(radians(LONGITUDE) - radians(?)) +
        sin(radians(?)) * sin(radians(LATITUDE))
    )) AS distance
FROM LM_MARKERS
HAVING distance < ?
ORDER BY distance
LIMIT ?;
```

---

## ğŸ› ì£¼ìš” ì´ìŠˆ ë° í•´ê²°

### ì´ìŠˆ 1: ë¬´í•œ ìŠ¤í¬ë¡¤ ì„±ëŠ¥ ìµœì í™”
**ë¬¸ì œ**:  
- ê³¼ë„í•œ ë¦¬ë Œë”ë§
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€
- ìŠ¤í¬ë¡¤ ì„±ëŠ¥ ì €í•˜

**í•´ê²° ê³¼ì •**:
1. `useCallback`ìœ¼ë¡œ í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
2. `useMemo`ë¡œ ê³„ì‚° ê²°ê³¼ ë©”ëª¨ì´ì œì´ì…˜
3. ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
4. í˜ì´ì§€ í¬ê¸° ì¡°ì • (10ê°œì”©)

**ì½”ë“œ**:
```javascript
const loadFeed = useCallback(async (pageNum, reset = false) => {
    if (loading) return;
    
    setLoading(true);
    try {
        const data = await getFeed(token, pageNum, 10);
        
        if (reset) {
            setMarkers(data.markers);
        } else {
            setMarkers(prev => [...prev, ...data.markers]);
        }
        
        setHasMore(data.markers.length >= 10);
    } catch (error) {
        console.error('í”¼ë“œ ë¡œë“œ ì‹¤íŒ¨:', error);
    } finally {
        setLoading(false);
    }
}, [token, tab, sort, isAuthenticated]);
```

### ì´ìŠˆ 2: ê²€ìƒ‰ ì„±ëŠ¥ ê°œì„ 
**ë¬¸ì œ**:  
- ì…ë ¥í•  ë•Œë§ˆë‹¤ API ìš”ì²­ ë°œìƒ
- ì„œë²„ ë¶€í•˜ ì¦ê°€
- ë¶ˆí•„ìš”í•œ ìš”ì²­

**í•´ê²° ê³¼ì •**:
1. ë””ë°”ìš´ì‹± ì ìš© (300ms)
2. ìµœì†Œ ê²€ìƒ‰ì–´ ê¸¸ì´ ì œí•œ (2ì)
3. ì„œë²„ ì‚¬ì´ë“œ í•„í„°ë§

**ì½”ë“œ**:
```javascript
const useDebounce = (value, delay) => {
    const [debouncedValue, setDebouncedValue] = useState(value);
    
    useEffect(() => {
        const handler = setTimeout(() => {
            setDebouncedValue(value);
        }, delay);
        
        return () => clearTimeout(handler);
    }, [value, delay]);
    
    return debouncedValue;
};

const debouncedSearchTerm = useDebounce(searchTerm, 300);
```

### ì´ìŠˆ 3: ê²€ìƒ‰ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸
**ë¬¸ì œ**:  
- ê²€ìƒ‰ì–´ê°€ ê²°ê³¼ì— í•˜ì´ë¼ì´íŠ¸ë˜ì§€ ì•ŠìŒ
- ì‚¬ìš©ìê°€ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì°¾ê¸° ì–´ë ¤ì›€

**í•´ê²° ê³¼ì •**:
1. ê²€ìƒ‰ì–´ë¥¼ ì •ê·œì‹ìœ¼ë¡œ ë³€í™˜
2. ê²°ê³¼ í…ìŠ¤íŠ¸ì—ì„œ ê²€ìƒ‰ì–´ ì°¾ê¸°
3. `<mark>` íƒœê·¸ë¡œ í•˜ì´ë¼ì´íŠ¸

**ì½”ë“œ**:
```javascript
const highlightText = (text, searchTerm) => {
    if (!searchTerm) return text;
    
    const regex = new RegExp(`(${searchTerm})`, 'gi');
    return text.replace(regex, '<mark>$1</mark>');
};
```

### ì´ìŠˆ 4: í”¼ë“œ íƒ­ ì „í™˜ ì‹œ ìƒíƒœ ì´ˆê¸°í™”
**ë¬¸ì œ**:  
- íƒ­ ì „í™˜ ì‹œ ì´ì „ ë°ì´í„°ê°€ ë‚¨ì•„ìˆìŒ
- ì •ë ¬ ë³€ê²½ ì‹œ ë°ì´í„°ê°€ ì„ì„

**í•´ê²° ê³¼ì •**:
1. íƒ­/ì •ë ¬ ë³€ê²½ ì‹œ ìƒíƒœ ì´ˆê¸°í™”
2. í˜ì´ì§€ ë²ˆí˜¸ ë¦¬ì…‹
3. ìƒˆë¡œ ë°ì´í„° ë¡œë“œ

**ì½”ë“œ**:
```javascript
useEffect(() => {
    setMarkers([]);
    setPage(1);
    setHasMore(true);
    loadFeed(1, true);
}, [tab, sort, isAuthenticated, loadFeed]);
```

---

## ğŸ“ ì½”ë“œ êµ¬ì¡°

### Frontend êµ¬ì¡°
```
frontend/src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ FeedPage.jsx         # í”¼ë“œ í˜ì´ì§€
â”‚   â””â”€â”€ MapPage.jsx          # ì§€ë„ í˜ì´ì§€ (ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€)
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ui/
â”‚       â””â”€â”€ MapSearchInput.jsx # ì§€ë„ ê²€ìƒ‰ ì…ë ¥
â””â”€â”€ hooks/
    â””â”€â”€ useMarkers.js        # ë§ˆì»¤ ë°ì´í„° ê´€ë¦¬ í›…
```

### Backend êµ¬ì¡°
```
backend/src/
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ feedController.js    # í”¼ë“œ ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â””â”€â”€ searchController.js # ê²€ìƒ‰ ì»¨íŠ¸ë¡¤ëŸ¬
â””â”€â”€ routes/
    â”œâ”€â”€ feedRoutes.js        # í”¼ë“œ ë¼ìš°í„°
    â””â”€â”€ searchRoutes.js      # ê²€ìƒ‰ ë¼ìš°í„°
```

---

## ğŸ’¡ ë°°ìš´ ì 

1. **ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„**
   - Intersection Observer API í™œìš©
   - ì„±ëŠ¥ ìµœì í™” ë°©ë²•
   - ìƒíƒœ ê´€ë¦¬

2. **ê²€ìƒ‰ ê¸°ëŠ¥**
   - ë””ë°”ìš´ì‹±ì„ í†µí•œ ì„±ëŠ¥ ê°œì„ 
   - ì„œë²„ ì‚¬ì´ë“œ í•„í„°ë§
   - ê²€ìƒ‰ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸

3. **í”¼ë“œ ì‹œìŠ¤í…œ**
   - íŒ”ë¡œì‰ í”¼ë“œ vs íƒìƒ‰ í”¼ë“œ
   - ì •ë ¬ ì˜µì…˜ êµ¬í˜„
   - íƒ­ ì „í™˜ ì‹œ ìƒíƒœ ê´€ë¦¬

4. **ì„±ëŠ¥ ìµœì í™”**
   - useCallback ë° useMemo í™œìš©
   - ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
   - í˜ì´ì§€ë„¤ì´ì…˜

---

## ğŸ“Š ì‘ì—… í†µê³„

- **ì‘ì„±í•œ íŒŒì¼ ìˆ˜**: ì•½ 6ê°œ
- **ì½”ë“œ ë¼ì¸ ìˆ˜**: ì•½ 2,000ì¤„
- **êµ¬í˜„í•œ API ì—”ë“œí¬ì¸íŠ¸**: 5ê°œ
- **ìƒì„±í•œ ì»´í¬ë„ŒíŠ¸**: 2ê°œ
- **ìƒì„±í•œ í›…**: 1ê°œ

---

## ğŸ¯ ë‚´ì¼ ê³„íš

1. Socket.io ì„œë²„ ì„¤ì •
2. Socket.io í´ë¼ì´ì–¸íŠ¸ í†µí•©
3. ì¼ëŒ€ì¼ ì±„íŒ… ê¸°ëŠ¥ êµ¬í˜„
4. ì±„íŒ…ë°© ëª©ë¡ ì¡°íšŒ
5. ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ì†¡ ë° ìˆ˜ì‹ 

---

## ğŸ“¸ ì°¸ê³  ìë£Œ

- [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- [React Hooks ìµœì í™”](https://react.dev/reference/react/useCallback)

---

**ì‘ì„±ì¼**: 2025ë…„ 11ì›” 29ì¼  
**ì‘ì„±ì**: [ì‘ì„±ìëª…]

